<div class="min-h-screen bg-[#f0fdf4] text-slate-800 p-6 lg:p-10 font-display">

  <div class="max-w-6xl mx-auto flex justify-between items-center mb-10">
    <div class="flex items-center gap-5">
      <button (click)="goBack()" class="size-11 flex items-center justify-center rounded-full bg-white border border-emerald-100 text-slate-400 hover:text-emerald-500 shadow-sm transition-all">
        <span class="material-symbols-outlined">arrow_back</span>
      </button>
      <div>
        <h1 class="text-3xl font-black uppercase tracking-tight">Teacher <span class="text-emerald-500">Portal</span></h1>
        <p class="text-slate-400 text-xs font-bold uppercase tracking-widest mt-1">Faculty management system</p>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <button *ngIf="viewMode === 'list' && canAddTeacher" (click)="addNewTeacher()"
              class="bg-[#f472b6] text-white px-6 py-3 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-pink-100 hover:bg-[#db2777] transition-all flex items-center gap-2">
        <span class="material-symbols-outlined text-sm">person_add</span> Add New Teacher
      </button>

      <button *ngIf="viewMode !== 'list' && canEditProfile"
              (click)="isEditMode = !isEditMode"
              [class]="isEditMode ? 'bg-orange-500 shadow-orange-100' : 'bg-emerald-500 shadow-emerald-100'"
              class="px-6 py-3 text-white rounded-full font-black uppercase text-[10px] transition-all shadow-lg flex items-center gap-2">
        <span class="material-symbols-outlined text-sm">{{isEditMode ? 'lock_open' : 'edit'}}</span>
        {{ isEditMode ? 'Editing Mode' : 'Edit Info' }}
      </button>
    </div>
  </div>

  <div *ngIf="viewMode === 'list'" class="max-w-6xl mx-auto space-y-8 animate-fade-in">
    <div class="flex justify-end">
      <div class="flex items-center bg-white border border-emerald-100 rounded-2xl px-5 py-3 w-96 shadow-sm focus-within:ring-2 ring-emerald-100 transition-all">
        <span class="material-symbols-outlined text-emerald-400 mr-3">search</span>
        <input type="text" [(ngModel)]="searchQuery" name="search" placeholder="Search No or Name..." class="bg-transparent border-none text-sm w-full outline-none">
      </div>
    </div>

    <div class="bg-white rounded-[2.5rem] border border-emerald-100 overflow-hidden shadow-xl shadow-emerald-500/5">
      <table class="w-full text-left">
        <thead class="bg-emerald-50/60 border-b border-emerald-100">
        <tr>
          <th class="p-6 text-[10px] font-black uppercase text-emerald-800 tracking-widest">No.</th>
          <th class="p-6 text-[10px] font-black uppercase text-emerald-800 tracking-widest">Teacher Name</th>
          <th class="p-6 text-[10px] font-black uppercase text-emerald-800 tracking-widest">Subject</th>
          <th class="p-6 text-center text-[10px] font-black uppercase text-emerald-800 tracking-widest">Action</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-emerald-50">
        <tr *ngFor="let t of filteredTeachers" class="hover:bg-emerald-50/30 transition-colors group">
          <td class="p-6 font-bold text-slate-400 text-xs">{{t.no}}</td>
          <td class="p-6">
            <div class="flex items-center gap-3">
              <div class="size-9 rounded-full bg-emerald-50 flex items-center justify-center text-emerald-600 border border-emerald-100 font-black text-[10px] uppercase">{{t.name.substring(0,2)}}</div>
              <span class="font-black text-slate-700 uppercase text-sm tracking-tight">{{t.name}}</span>
            </div>
          </td>
          <td class="p-6 text-slate-500 font-bold text-xs uppercase tracking-wider">{{t.subject}}</td>
          <td class="p-6 text-center">
            <button (click)="selectTeacher(t)" class="text-[10px] font-black uppercase px-5 py-2 bg-white border border-emerald-100 text-emerald-600 rounded-xl hover:bg-emerald-500 hover:text-white transition-all shadow-sm">View Info</button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="viewMode !== 'list'" class="max-w-6xl mx-auto space-y-8 animate-fade-in-up">

    <nav class="flex gap-8 border-b border-emerald-100 pb-4 overflow-x-auto">
      <button (click)="viewMode = 'profile'" [class.text-emerald-600]="viewMode === 'profile'" [class.border-emerald-500]="viewMode === 'profile'" class="text-[10px] font-black uppercase tracking-widest whitespace-nowrap border-b-2 border-transparent pb-4 transition-all">1. Profile & Contact</button>
      <button (click)="viewMode = 'teaching'" [class.text-emerald-600]="viewMode === 'teaching'" [class.border-emerald-500]="viewMode === 'teaching'" class="text-[10px] font-black uppercase tracking-widest whitespace-nowrap border-b-2 border-transparent pb-4 transition-all">2. Teaching & Philosophy</button>
      <button (click)="viewMode = 'schedule'" [class.text-emerald-600]="viewMode === 'schedule'" [class.border-emerald-500]="viewMode === 'schedule'" class="text-[10px] font-black uppercase tracking-widest whitespace-nowrap border-b-2 border-transparent pb-4 transition-all">3. Schedule</button>
      <button (click)="viewMode = 'certs'" [class.text-emerald-600]="viewMode === 'certs'" [class.border-emerald-500]="viewMode === 'certs'" class="text-[10px] font-black uppercase tracking-widest whitespace-nowrap border-b-2 border-transparent pb-4 transition-all">4. Professional & Certs</button>
    </nav>

    <div *ngIf="viewMode === 'profile'" class="grid md:grid-cols-2 gap-8">
      <div class="bg-white p-10 rounded-[2.5rem] border border-emerald-50 shadow-sm space-y-8">
        <h3 class="text-[10px] font-black text-slate-400 uppercase tracking-widest border-b border-emerald-50 pb-4">Personal Details</h3>
        <div class="space-y-6">
          <div class="space-y-1">
            <label class="text-[9px] font-black text-emerald-600 uppercase tracking-widest">Full Name</label>
            <input [(ngModel)]="selectedTeacher.name" name="n" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm font-black uppercase outline-none focus:ring-2 ring-emerald-100">
          </div>
          <div class="space-y-1">
            <label class="text-[9px] font-black text-emerald-600 uppercase tracking-widest">Subject Specialization</label>
            <input [(ngModel)]="selectedTeacher.subject" name="sub" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm font-bold uppercase outline-none focus:ring-2 ring-emerald-100">
          </div>
        </div>
      </div>
      <div class="bg-white p-10 rounded-[2.5rem] border border-emerald-50 shadow-sm space-y-8">
        <h3 class="text-[10px] font-black text-slate-400 uppercase tracking-widest border-b border-emerald-50 pb-4">Contact Information</h3>
        <div class="space-y-6">
          <div class="grid grid-cols-2 gap-4">
            <div class="space-y-1"><label class="text-[9px] font-black text-emerald-600 uppercase">Phone Number</label>
              <input [(ngModel)]="selectedTeacher.phone" name="ph" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm outline-none"></div>
            <div class="space-y-1"><label class="text-[9px] font-black text-emerald-600 uppercase">Professional Email</label>
              <input [(ngModel)]="selectedTeacher.email" name="em" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm outline-none"></div>
          </div>
          <div class="space-y-1"><label class="text-[9px] font-black text-emerald-600 uppercase">LinkedIn / Website</label>
            <input [(ngModel)]="selectedTeacher.linkedIn" name="li" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm outline-none"></div>
        </div>
      </div>
    </div>

    <div *ngIf="viewMode === 'teaching'" class="space-y-8">
      <div class="bg-white p-10 rounded-[2.5rem] border border-emerald-50 shadow-sm space-y-4">
        <h3 class="text-[10px] font-black text-emerald-600 uppercase tracking-widest">Professional Title / Summary</h3>
        <textarea [(ngModel)]="selectedTeacher.summary" name="sum" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-2xl p-6 text-sm h-32 outline-none resize-none focus:ring-2 ring-emerald-100 transition-all"></textarea>
      </div>
      <div class="grid md:grid-cols-2 gap-8">
        <div class="bg-white p-10 rounded-[2.5rem] border border-emerald-50 shadow-sm space-y-4">
          <h4 class="text-[10px] font-black text-emerald-600 uppercase tracking-widest">Hard Skills</h4>
          <textarea [(ngModel)]="selectedTeacher.hardSkills" name="hs" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-2xl p-6 text-sm h-32 outline-none resize-none"></textarea>
        </div>
        <div class="bg-white p-10 rounded-[2.5rem] border border-emerald-50 shadow-sm space-y-4">
          <h4 class="text-[10px] font-black text-emerald-600 uppercase tracking-widest">Soft Skills</h4>
          <textarea [(ngModel)]="selectedTeacher.softSkills" name="ss" [readonly]="!isEditMode" class="w-full bg-slate-50 border border-slate-100 rounded-2xl p-6 text-sm h-32 outline-none resize-none"></textarea>
        </div>
      </div>
      <div class="bg-white p-10 rounded-[2.5rem] border border-emerald-50 shadow-sm space-y-4">
        <h3 class="text-[10px] font-black text-emerald-600 uppercase tracking-widest">Teaching Philosophy</h3>
        <textarea [(ngModel)]="selectedTeacher.philosophy" name="phi" [readonly]="!isEditMode" class="w-full bg-emerald-50/20 border border-emerald-100 rounded-2xl p-6 text-sm h-40 outline-none resize-none italic text-slate-600"></textarea>
      </div>
    </div>

    <div *ngIf="viewMode === 'schedule'" class="bg-white rounded-[3rem] border border-emerald-100 overflow-hidden shadow-xl shadow-emerald-500/5">
      <div class="bg-slate-800 p-5 px-10 text-[10px] font-black text-white uppercase tracking-widest">Weekly Teaching Schedule (Sun - Thu)</div>
      <div class="p-10">
        <table class="w-full text-left text-sm">
          <thead class="text-slate-400 border-b border-slate-100 uppercase text-[9px] font-black">
          <tr><th class="pb-5 px-4">Day</th><th class="pb-5 px-4">Time Slot</th><th class="pb-5 px-4">Subject</th><th class="pb-5 px-4">Class</th></tr>
          </thead>
          <tbody class="divide-y divide-slate-50">
          <tr *ngFor="let s of selectedTeacher.schedule; let i = index" class="hover:bg-emerald-50/20 transition-colors">
            <td class="py-6 px-4 font-black text-emerald-600 uppercase text-xs">{{s.day}}</td>
            <td class="py-6 px-4"><input [(ngModel)]="s.time" name="t{{i}}" [readonly]="!isEditMode" class="bg-transparent border-none outline-none font-medium text-slate-500"></td>
            <td class="py-6 px-4"><input [(ngModel)]="s.subject" name="s{{i}}" [readonly]="!isEditMode" class="bg-transparent border-none outline-none font-black text-slate-700 uppercase"></td>
            <td class="py-6 px-4"><input [(ngModel)]="s.class" name="c{{i}}" [readonly]="!isEditMode" class="bg-transparent border-none outline-none font-bold text-xs text-slate-400"></td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div *ngIf="viewMode === 'certs'" class="space-y-8">
      <input type="file" id="certUpload" class="hidden" (change)="onFileSelected($event)">
      <div class="bg-white rounded-[3rem] border border-emerald-100 overflow-hidden shadow-xl shadow-emerald-500/5">
        <div class="bg-emerald-600 p-5 px-10 text-[10px] font-black text-white uppercase flex justify-between items-center tracking-widest">
          <span>Official Certifications & Records</span>
          <button (click)="triggerFileUpload()" [disabled]="!isEditMode"
                  [class.opacity-50]="!isEditMode"
                  class="bg-white/20 hover:bg-white/30 px-5 py-2 rounded-xl flex items-center gap-2 transition-all">
            <span class="material-symbols-outlined text-sm">upload_file</span> Upload New Cert
          </button>
        </div>
        <div class="p-10 space-y-6">
          <div *ngFor="let cert of selectedTeacher.certificates" class="bg-slate-50 p-7 rounded-[2rem] border border-slate-100 flex justify-between items-center group hover:border-emerald-200 transition-all">
            <div class="flex items-center gap-5">
              <div class="size-12 rounded-2xl bg-white flex items-center justify-center text-emerald-500 shadow-sm"><span class="material-symbols-outlined">description</span></div>
              <div><p class="font-black text-slate-700 uppercase text-sm">{{cert.name}}</p><p class="text-[10px] text-slate-400 font-bold uppercase mt-1">{{cert.date}}</p></div>
            </div>
            <button (click)="downloadFile(cert.fileName)" class="text-emerald-600 text-[10px] font-black uppercase flex items-center gap-2 px-4 py-2 bg-white rounded-xl shadow-sm hover:bg-emerald-500 hover:text-white transition-all">
              <span class="material-symbols-outlined text-sm">download</span> Download
            </button>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="isEditMode" class="flex justify-end pt-4 pb-12">
      <button (click)="saveData()" class="px-16 py-5 bg-emerald-500 text-white font-black uppercase tracking-widest rounded-full shadow-2xl shadow-emerald-200 hover:scale-105 transition-all flex items-center gap-3">
        <span class="material-symbols-outlined">save</span>
        SAVE CHANGES & LOCK
      </button>
    </div>

  </div>
</div>
