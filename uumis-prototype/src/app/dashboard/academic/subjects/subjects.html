<div class="min-h-screen bg-[#f0fdf4] font-display text-slate-800 flex flex-col relative">

  <header class="bg-white border-b border-emerald-100 px-8 py-8 flex flex-col gap-6 sticky top-0 z-40 shadow-sm">
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
      <div class="flex items-center gap-5">
        <button (click)="goBack()" class="size-11 flex items-center justify-center rounded-full bg-white border border-emerald-100 text-slate-400 hover:text-emerald-500 hover:border-emerald-300 shadow-sm transition-all group">
          <span class="material-symbols-outlined">arrow_back</span>
        </button>

        <div>
          <h2 class="text-3xl font-black text-emerald-900 uppercase">Subjects <span class="text-emerald-500">& Courses</span></h2>
          <p class="text-slate-400 text-xs font-bold uppercase tracking-widest mt-1">Manage school curriculum</p>
        </div>
      </div>

      <button (click)="addNewSubject()" class="flex items-center justify-center gap-2 bg-[#30e87a] hover:bg-emerald-500 text-emerald-950 font-black py-4 px-8 rounded-2xl transition-all shadow-lg shadow-emerald-200 uppercase text-xs">
        <span class="material-symbols-outlined">add_circle</span><span>Add New Subject</span>
      </button>
    </div>

    <div class="flex flex-col lg:flex-row gap-6 items-center">
      <div class="relative flex-1 w-full max-w-xl">
        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-emerald-400 material-symbols-outlined">search</span>
        <input [(ngModel)]="searchQuery" class="w-full pl-12 pr-4 py-4 rounded-2xl border-none bg-emerald-50/50 focus:ring-2 focus:ring-emerald-400 text-sm shadow-inner" placeholder="Search subjects...">
      </div>
      <div class="flex items-center gap-3 overflow-x-auto pb-2 lg:pb-0">
        <button *ngFor="let cat of ['All', 'Languages', 'Core Sciences', 'Arts & Humanities', 'Humanities']"
                (click)="selectedCategory = cat"
                [class]="selectedCategory === cat ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-400 border border-emerald-50'"
                class="px-5 py-2.5 rounded-full text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap">
          {{cat}}
        </button>
      </div>
    </div>
  </header>

  <div class="flex-1 overflow-y-auto px-8 py-10">
    <div class="bg-white rounded-[3rem] border border-emerald-100 shadow-xl shadow-emerald-500/5 overflow-visible">
      <table class="w-full text-left border-collapse">
        <thead>
        <tr class="border-b border-emerald-50 bg-emerald-50/30">
          <th class="px-8 py-5 text-[10px] font-black text-emerald-800 uppercase tracking-widest">Subject Name</th>
          <th class="px-8 py-5 text-[10px] font-black text-emerald-800 uppercase tracking-widest">Code</th>
          <th class="px-8 py-5 text-[10px] font-black text-emerald-800 uppercase tracking-widest">Category</th>
          <th class="px-8 py-5 text-[10px] font-black text-emerald-800 uppercase tracking-widest text-center">Status</th>
          <th class="px-8 py-5 text-[10px] font-black text-emerald-800 uppercase tracking-widest text-right">Actions</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-emerald-50">
        <tr *ngFor="let s of filteredSubjects; let i = index" class="group hover:bg-emerald-50/20 transition-colors">
          <td class="px-8 py-6">
            <div class="flex items-center gap-4 relative">
              <div class="relative">
                <button (click)="s.isEditing ? showIconPickerIndex = i : null"
                        [disabled]="!s.isEditing"
                        [class.cursor-pointer]="s.isEditing"
                        class="h-12 w-12 rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-500 shadow-sm border border-emerald-100">
                  <span class="material-symbols-outlined text-[24px]">{{s.icon}}</span>
                </button>
                <div *ngIf="showIconPickerIndex === i" class="absolute top-14 left-0 bg-white p-3 rounded-2xl shadow-2xl border border-emerald-100 z-50 grid grid-cols-5 gap-2 w-52 animate-fade-in">
                  <button *ngFor="let ic of availableIcons" (click)="selectIcon(s, ic)" class="h-8 w-8 hover:bg-emerald-50 rounded-lg flex items-center justify-center text-emerald-500"><span class="material-symbols-outlined text-sm">{{ic}}</span></button>
                </div>
              </div>
              <div class="flex flex-col">
                <input *ngIf="s.isEditing" [(ngModel)]="s.name" class="bg-slate-50 border-emerald-200 border rounded-lg px-2 py-1 text-sm font-bold w-64 outline-none">
                <span *ngIf="!s.isEditing" class="text-sm font-black text-slate-700 uppercase tracking-tight">{{s.name}}</span>
                <span class="text-[10px] text-slate-400 font-bold uppercase">Academic Curriculum</span>
              </div>
            </div>
          </td>
          <td class="px-8 py-6">
            <input *ngIf="s.isEditing" [(ngModel)]="s.code" class="bg-slate-50 border-emerald-200 border rounded-lg px-2 py-1 w-20 text-xs font-mono outline-none">
            <span *ngIf="!s.isEditing" class="font-mono text-sm font-bold text-emerald-600">{{s.code}}</span>
          </td>
          <td class="px-8 py-6">
            <select *ngIf="s.isEditing" [(ngModel)]="s.category" class="bg-slate-50 border-emerald-200 border rounded-lg text-xs p-1 outline-none">
              <option *ngFor="let cat of categories" [value]="cat">{{cat}}</option>
            </select>
            <span *ngIf="!s.isEditing" class="px-3 py-1 rounded-full text-[9px] font-black uppercase bg-emerald-50 text-emerald-700 border border-white/50 shadow-sm">{{s.category}}</span>
          </td>
          <td class="px-8 py-6 text-center"><div class="inline-flex items-center gap-2 px-3 py-1 bg-green-50 text-green-600 rounded-full text-[10px] font-black uppercase"><span class="h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"></span> Active</div></td>
          <td class="px-8 py-6 text-right"><div class="flex justify-end gap-2"><button (click)="toggleEdit(s, i)" class="p-2 rounded-xl hover:bg-emerald-100 text-emerald-600 transition-all"><span class="material-symbols-outlined text-[20px]">{{ s.isEditing ? 'check_circle' : 'edit' }}</span></button><button (click)="deleteSubject(i)" class="p-2 rounded-xl hover:bg-red-50 text-red-400 transition-all"><span class="material-symbols-outlined text-[20px]">delete</span></button></div></td>
        </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-12 flex justify-end pb-10">
      <button (click)="saveAll()" class="px-16 py-5 bg-emerald-600 text-white font-black uppercase tracking-widest rounded-full shadow-2xl shadow-emerald-200 hover:scale-105 transition-all flex items-center gap-3">
        <span class="material-symbols-outlined">save</span>Submit Changes
      </button>
    </div>
  </div>
</div>
