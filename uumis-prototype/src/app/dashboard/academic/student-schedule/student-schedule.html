<div class="min-h-screen bg-[#f0fdf4] font-display text-slate-800 flex flex-col">

  <header class="bg-white border-b border-emerald-100 px-8 py-8 flex flex-col gap-6 sticky top-0 z-40 shadow-sm">
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
      <div class="flex items-center gap-5">
        <button (click)="goBack()" class="size-11 flex items-center justify-center rounded-full bg-white border border-emerald-100 text-slate-400 hover:text-emerald-500 shadow-sm transition-all">
          <span class="material-symbols-outlined font-bold">arrow_back</span>
        </button>
        <div>
          <h2 class="text-3xl font-black text-emerald-900 uppercase">Student <span class="text-emerald-500">Schedule</span></h2>
          <p class="text-slate-400 text-xs font-bold uppercase tracking-widest mt-1">Manage Class Timings & Content</p>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <button *ngIf="isEditMode" (click)="addColumn()"
                class="h-11 px-6 bg-[#f472b6] hover:bg-[#db2777] text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-lg shadow-pink-100 transition-all flex items-center gap-2 transform hover:-translate-y-0.5">
          <span class="text-lg font-bold leading-none">+</span>
          <span>Add Column</span>
        </button>

        <button (click)="toggleEditMode()"
                [class]="isEditMode ? 'bg-orange-500 shadow-orange-100' : 'bg-emerald-500 shadow-emerald-100'"
                class="h-11 px-6 text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-lg transition-all flex items-center gap-2 transform hover:-translate-y-0.5">
          <span class="material-symbols-outlined text-[18px]">{{ isEditMode ? 'close' : 'edit_calendar' }}</span>
          <span>{{ isEditMode ? 'Cancel Edit' : 'Edit Schedule' }}</span>
        </button>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Selected Level:</span>
      <select [(ngModel)]="selectedLevel" class="bg-emerald-50 border-none rounded-xl px-4 py-2 text-xs font-black text-emerald-700 outline-none cursor-pointer">
        <option *ngFor="let lvl of levels" [value]="lvl">{{lvl}}</option>
      </select>
    </div>
  </header>

  <div class="flex-1 overflow-y-auto px-8 py-10">
    <div class="bg-white rounded-[3rem] border border-emerald-100 shadow-xl shadow-emerald-500/5 overflow-hidden">

      <div class="bg-emerald-600 px-10 py-5 flex justify-center">
        <h3 class="text-white font-black uppercase tracking-[0.2em] text-sm">{{selectedLevel}} MANAGEMENT</h3>
      </div>

      <div class="overflow-x-auto custom-scrollbar">
        <table class="w-full border-collapse text-center">
          <thead>
          <tr class="bg-emerald-50/50 border-b border-emerald-100">
            <th class="p-6 border-r border-emerald-100 whitespace-nowrap min-w-[120px]"></th>
            <th *ngFor="let h of scheduleData[selectedLevel].headers; let j = index"
                class="p-4 min-w-[180px] whitespace-nowrap">
              <input *ngIf="isEditMode" [(ngModel)]="scheduleData[selectedLevel].headers[j]"
                     class="w-full bg-white border border-emerald-200 rounded-lg p-2 text-[10px] font-black text-center text-emerald-800 uppercase outline-none focus:ring-2 ring-emerald-400">
              <span *ngIf="!isEditMode" class="text-[10px] font-black text-emerald-800 uppercase tracking-tight block w-full">{{h}}</span>
            </th>
          </tr>
          </thead>
          <tbody class="divide-y divide-emerald-50">
          <tr *ngFor="let day of days; let i = index" class="group hover:bg-emerald-50/20 transition-colors">
            <td class="p-6 font-black text-emerald-600 bg-emerald-50/30 text-xs border-r border-emerald-100 whitespace-nowrap">{{day}}</td>

            <td *ngFor="let slot of scheduleData[selectedLevel].rows[i]; let j = index" class="p-4 border-l border-emerald-50">
                <textarea *ngIf="isEditMode" [(ngModel)]="scheduleData[selectedLevel].rows[i][j]"
                          placeholder="Subject / Activity"
                          class="w-full bg-slate-50 border border-emerald-100 rounded-xl p-3 text-[11px] font-bold text-center outline-none focus:ring-2 ring-emerald-300 resize-none h-16"></textarea>
              <div *ngIf="!isEditMode" class="min-h-[40px] flex items-center justify-center p-2">
                <span class="text-xs font-black text-slate-700 uppercase tracking-tighter break-words">{{ scheduleData[selectedLevel].rows[i][j] || '-' }}</span>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-12 flex justify-end pb-12">
      <button (click)="submitSchedule()" class="px-16 py-5 bg-emerald-500 text-white font-black uppercase tracking-widest rounded-full shadow-2xl shadow-emerald-200 hover:scale-105 transition-all flex items-center gap-3">
        <span class="material-symbols-outlined">cloud_done</span>
        Save & Submit Changes
      </button>
    </div>
  </div>
</div>
