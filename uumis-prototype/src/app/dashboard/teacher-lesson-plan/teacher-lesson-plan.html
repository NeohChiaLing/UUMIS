<div class="min-h-screen bg-[#f0fdf4] font-display text-slate-800 flex flex-col relative">

  <div *ngIf="isViewingPDF" class="fixed inset-0 z-[100] flex items-center justify-center bg-emerald-900/40 backdrop-blur-md p-6 lg:p-12 animate-fade-in">
    <div class="bg-white w-full h-full rounded-[3rem] border border-emerald-100 shadow-2xl overflow-hidden flex flex-col">
      <div class="px-10 py-6 border-b border-emerald-50 flex justify-between items-center bg-white shrink-0">
        <div class="flex items-center gap-4">
          <div class="size-10 rounded-xl bg-emerald-50 flex items-center justify-center text-emerald-600"><span class="material-symbols-outlined">description</span></div>
          <h3 class="text-xl font-black text-emerald-900 uppercase">Document <span class="text-emerald-500">Preview</span></h3>
        </div>
        <button (click)="closePDFViewer()" class="px-6 py-2.5 bg-rose-50 text-rose-500 rounded-xl font-black uppercase text-[10px] hover:bg-rose-500 hover:text-white transition-all flex items-center gap-2">
          <span class="material-symbols-outlined text-sm">close</span> Close Preview
        </button>
      </div>
      <div class="flex-1 bg-slate-100 p-4">
        <iframe *ngIf="currentPdfUrl" [src]="currentPdfUrl" class="w-full h-full rounded-2xl border-none shadow-inner"></iframe>
      </div>
    </div>
  </div>

  <div *ngIf="isAddingMode" class="fixed inset-0 z-50 flex items-center justify-center bg-emerald-900/20 backdrop-blur-sm animate-fade-in">
    <div class="bg-white w-full max-w-lg p-10 rounded-[3rem] border border-emerald-100 shadow-2xl space-y-8">
      <div class="flex justify-between items-center">
        <h3 class="text-2xl font-black text-emerald-900 uppercase">Add New <span class="text-emerald-500">Plan</span></h3>
        <button (click)="toggleAddingMode()" class="text-slate-300 hover:text-rose-500 transition-colors"><span class="material-symbols-outlined">close</span></button>
      </div>

      <div class="space-y-6">
        <div class="space-y-1">
          <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Teacher Name</label>
          <input [(ngModel)]="newPlanForm.teacherName" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm font-bold outline-none focus:ring-2 ring-emerald-100">
        </div>
        <div class="space-y-1">
          <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Subject Name</label>
          <input [(ngModel)]="newPlanForm.subjectName" class="w-full bg-slate-50 border border-slate-100 rounded-xl p-4 text-sm font-bold outline-none focus:ring-2 ring-emerald-100">
        </div>
        <div class="space-y-1">
          <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Lesson Plan PDF</label>
          <div (click)="fileInput.click()" class="w-full border-2 border-dashed border-emerald-200 rounded-2xl p-6 flex flex-col items-center justify-center gap-2 cursor-pointer hover:bg-emerald-50 transition-all">
            <span class="material-symbols-outlined text-emerald-400 text-3xl">upload_file</span>
            <span class="text-xs font-bold text-emerald-600 truncate max-w-full px-4">{{ newPlanForm.fileName || 'Click to Upload Syllabus PDF' }}</span>
            <input #fileInput type="file" class="hidden" (change)="onFileSelected($event)" accept="application/pdf">
          </div>
        </div>
      </div>

      <button (click)="submitNewPlan()" class="w-full py-5 bg-emerald-500 text-white font-black uppercase tracking-widest rounded-full shadow-lg hover:scale-105 transition-all">
        Submit to Review List
      </button>
    </div>
  </div>

  <header class="bg-white border-b border-emerald-100 px-8 py-8 flex flex-col gap-6 sticky top-0 z-40 shadow-sm">
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
      <div class="flex items-center gap-5">
        <button (click)="goBack()" class="size-11 flex items-center justify-center rounded-full bg-white border border-emerald-100 text-slate-400 hover:text-emerald-500 shadow-sm transition-all"><span class="material-symbols-outlined font-bold">arrow_back</span></button>
        <div>
          <h1 class="text-3xl font-black text-emerald-900 uppercase">Lesson Plan <span class="text-emerald-500">Review</span></h1>
          <p class="text-slate-400 text-[10px] font-black uppercase tracking-[0.2em] mt-1">Syllabus Verification & Approval</p>
        </div>
      </div>
      <button (click)="toggleAddingMode()" class="flex items-center gap-2 px-6 py-3 bg-[#f472b6] text-white rounded-xl font-black uppercase text-[10px] shadow-lg shadow-pink-100 hover:bg-[#db2777] transition-all">
        <span class="text-lg leading-none">+</span> Add Lesson Plan
      </button>
    </div>
  </header>

  <div class="flex-1 overflow-y-auto px-8 py-10">
    <div class="bg-white rounded-[3rem] border border-emerald-100 shadow-xl shadow-emerald-500/5 overflow-hidden">
      <table class="w-full text-left border-collapse">
        <thead>
        <tr class="bg-emerald-50/40 border-b border-emerald-50 text-[10px] font-black text-emerald-800 uppercase tracking-widest">
          <th class="px-8 py-5">Teacher</th><th class="px-8 py-5">Subject & Topic</th><th class="px-8 py-5">Grade</th><th class="px-8 py-5">Status</th><th class="px-8 py-5 text-right">Actions</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-emerald-50">
        <tr *ngFor="let p of lessonPlans" class="group hover:bg-emerald-50/20 transition-all">
          <td class="px-8 py-6"><div class="flex items-center gap-3"><div class="size-9 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-700 font-black text-xs border border-emerald-200">{{p.avatar}}</div><div><p class="text-sm font-black text-slate-700 uppercase">{{p.teacher}}</p><p class="text-[10px] text-slate-400 font-bold">ID: {{p.id}}</p></div></div></td>
          <td class="px-8 py-6"><div class="flex items-center gap-2"><span class="px-2 py-0.5 rounded-lg bg-emerald-50 text-emerald-600 text-[9px] font-black uppercase">{{p.subject}}</span><span class="text-xs font-black text-slate-700 uppercase tracking-tight">{{p.topic}}</span></div></td>
          <td class="px-8 py-6"><span class="text-xs font-bold text-slate-500 uppercase">{{p.grade}}</span></td>
          <td class="px-8 py-6">
              <span [ngClass]="{'bg-blue-50 text-blue-600 border-blue-100': p.status === 'Pending Review', 'bg-emerald-50 text-emerald-600 border-emerald-100': p.status === 'Approved', 'bg-rose-50 text-rose-500 border-rose-100': p.status === 'Needs Revision'}" class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[9px] font-black uppercase border">
                <span class="size-1.5 rounded-full" [ngClass]="{'bg-blue-500': p.status === 'Pending Review', 'bg-emerald-500': p.status === 'Approved', 'bg-rose-500': p.status === 'Needs Revision'}"></span> {{p.status}}
              </span>
          </td>
          <td class="px-8 py-6 text-right">
            <div class="flex items-center justify-end gap-2">
              <button (click)="viewPDF(p)" class="p-2.5 bg-sky-50 text-sky-600 rounded-xl hover:bg-sky-500 hover:text-white transition-all shadow-sm" title="View PDF"><span class="material-symbols-outlined text-[20px]">visibility</span></button>
              <button (click)="downloadPDF(p)" class="p-2.5 bg-slate-100 text-slate-500 rounded-xl hover:bg-slate-700 hover:text-white transition-all shadow-sm" title="Download"><span class="material-symbols-outlined text-[20px]">download</span></button>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
